import structlog

from util.constants import SUPPORTED_SHARING, EPSILON, SNR_NOISE_LOW, SNR_NOISE_HIGH, B_IN_MB, BITS_IN_BYTE, \
    SNR_NOISE_UNIT, TOTAL_VIDEO_CHUNKS, MPC_FUTURE_CHUNK_COUNT
import numpy as np

SNR_THRESHOLD = 2e-8

TMP_SNR = {
    50: [
        [0.978853848032438, 0.9382560820857074, 0.9675461152915266, 1, 0.9577797655189708, 0.923695842034908, 0.9721817332681983, 1, 1, 1, 1, 1, 1, 1, 1, 0.9692891603598139, 0.9711280392502496, 1, 0.9913859319110941, 0.9513317391857605, 0.944745421612361, 0.9354440118191168, 0.9723711768049565, 1, 1, 0.9960297898858861, 1, 1, 0.9786761513251866, 0.9934806573678557, 0.9687410059512311, 1, 0.9949607924712068, 1, 0.9637525332775981, 1, 0.9688022679975166, 0.9329424733783811, 0.8887046528832709, 0.8411490477349477, 0.8414619246795281, 0.8046350416446519, 0.8148553765441571, 0.8247249646180027, 0.8304487138976068, 0.8380752427305913, 0.8506775271460228, 0.8936323938466401, 0.941270938662415],
        [0.5988508990301651, 0.630366384238783, 0.6713128541314884, 0.6661487958975103, 0.6837725852388, 0.6832115038957327, 0.7190747680560797, 0.6910910584383048, 0.7131950084878207, 0.7607215067610865, 0.7773636796990233, 0.758635459127976, 0.7796734569813274, 0.7537131364243073, 0.7237379371700599, 0.676102314337192, 0.72434002615375, 0.6873811037024214, 0.695456800163106, 0.7226723121507915, 0.6780536565823291, 0.6807101401560327, 0.6937726267606644, 0.6862530580837306, 0.6936898415102563, 0.6673718306629821, 0.7033841346215594, 0.6990343121641432, 0.6900433178862642, 0.6545087479881466, 0.6378030810326808, 0.5949066131282662, 0.5981688182675696, 0.5768234435916884, 0.6168101990561297, 0.6015526229501196, 0.6155480546642632, 0.6047400193356214, 0.5659591214314474, 0.6110860838444383, 0.5850031488967448, 0.5865706335764715, 0.6040032107305141, 0.5811352135774172, 0.6272936560554906, 0.6590505218125586, 0.6590239468564916, 0.6428665059942623, 0.6397459494181232],
        [0.6496810607090193, 0.6024507522586617, 0.5939457503931748, 0.599287735733536, 0.6186263613001032, 0.6559219831932952, 0.643931944920996, 0.6694469192893616, 0.6237737146265019, 0.6221464680242943, 0.5861561705073867, 0.5886360717788865, 0.6119560165261478, 0.5674361604136008, 0.5269785387869066, 0.5292785319973332, 0.5779724964562738, 0.5311427123299441, 0.5063600062606542, 0.5022331146731768, 0.5, 0.5, 0.5, 0.5, 0.5357438439112205, 0.5397141498533881, 0.5128203884445741, 0.5, 0.530136237792602, 0.575952933419885, 0.6116258358751749, 0.5885880527868905, 0.5582147266980118, 0.556199418162077, 0.5395333517901479, 0.5291374424841868, 0.5673681721456123, 0.5272388303762353, 0.5321866656200421, 0.5476050853562985, 0.5694545162072923, 0.6090973454555778, 0.5698610180386162, 0.5246758584542062, 0.5, 0.5412586643977374, 0.5861333470961776, 0.5947227487971033, 0.572358476502725],
        [0.7219076333308321, 0.7294212952872186, 0.7275929162735614, 0.733899475460986, 0.7505431341367086, 0.7814360579783992, 0.812900959320859, 0.7796374575846938, 0.7710402532777632, 0.7603609874031985, 0.7657049150136711, 0.7654282154226613, 0.7674866912264644, 0.796325347880495, 0.7945825195120979, 0.8350359375107594, 0.8131918863615013, 0.8373789425874599, 0.8865558448695404, 0.8458026986862535, 0.7991202204406084, 0.7543395127981434, 0.766567081368534, 0.745290005409746, 0.7446254473153587, 0.7470512168390604, 0.7122705690859139, 0.7322713710972759, 0.7461170628180309, 0.7875098407120591, 0.8045848480585268, 0.822806988142077, 0.8573994514232448, 0.8957500078202011, 0.8459653230098036, 0.8459178760066295, 0.8662005167294178, 0.903513550326957, 0.8602800389517901, 0.8722641019492317, 0.8355785671623486, 0.8750952228449055, 0.8693549894001948, 0.8877335881155558, 0.8882724938500325, 0.8968815127935625, 0.9109379666688314, 0.8790608705804155, 0.8868151223794652],
    ], 60: [
        [0.8145441071190311, 0.8127056074917223, 0.8317251872019263, 0.8657856527868365, 0.8255134810527155, 0.84414686032774, 0.859852619203778, 0.827610412595408, 0.8657616372083176, 0.8800701527875551, 0.9267031766084913, 0.8869021113455617, 0.9296584497553544, 0.9298164661487227, 0.9503836616300039, 0.9932089854802928, 1, 0.9972938550121695, 0.9637435563755579, 0.9597947745797138, 0.9316770515762981, 0.9242050352243417, 0.9452769656843645, 0.9344103858721711, 0.9346046676392163, 0.9174127948720415, 0.9193341498992672, 0.874250404972009, 0.8926611406586797, 0.8572685310379634, 0.8355785155663245, 0.8436180135078089, 0.8905573569057385, 0.8431631316069288, 0.8398313623682535, 0.8227361727401907, 0.8568693918631162, 0.8766935445399698, 0.8571603073837062, 0.9041921697831731, 0.9471624667655175, 0.9065681399182823, 0.9249747767431438, 0.9174914549535456, 0.9444889630322295, 0.917478667744452, 0.9296512468437942, 0.8992594127053958, 0.9117350767822469],
        [0.6831527163560259, 0.6335706215519024, 0.6372601540767318, 0.6, 0.6271155632668293, 0.6007094824133242, 0.6, 0.6, 0.6243598586241081, 0.6034641361680592, 0.6, 0.6, 0.6, 0.6155772914316873, 0.6, 0.6, 0.6112317731990144, 0.6022076931105635, 0.638895463027977, 0.6631925615620977, 0.6189222019083652, 0.6659008005444431, 0.7024406700089507, 0.7517779932402329, 0.7985050202920772, 0.8329751233642384, 0.8511665346592237, 0.8676630658793668, 0.8607319399112826, 0.8348792580989458, 0.8588748144853697, 0.9001030582881613, 0.866673350070917, 0.8822213618120419, 0.8924989658152873, 0.8494623377683708, 0.894581222133482, 0.9148725291791835, 0.9003444797953944, 0.8983418566978759, 0.9266603084563881, 0.8884908477699753, 0.9196265453383006, 0.8835314022065648, 0.8984265612877005, 0.8828384229612255, 0.8500610419126333, 0.8306942450788514, 0.8795023071399265],
        [0.6634213797651269, 0.6844982625255113, 0.639205885732991, 0.6, 0.6, 0.6, 0.6035287135493633, 0.6, 0.6, 0.6, 0.6, 0.6026151603007757, 0.6, 0.6331077201573084, 0.6729745390373155, 0.6522247885409124, 0.7011686537032616, 0.7079754427400112, 0.6990362213907106, 0.7159164355311418, 0.6907571069394004, 0.6959473074562254, 0.6813295658674283, 0.6376310942133889, 0.6681848704878594, 0.6361441133846396, 0.6162092453571317, 0.6632408508756493, 0.6320519156064133, 0.6418726901173845, 0.6414362842620458, 0.6549784541561907, 0.6532299655246762, 0.700940643822475, 0.7170445124952859, 0.672830755432768, 0.6637210990358122, 0.6167072910821279, 0.6180271168622202, 0.6, 0.6368271593096941, 0.6619603333915193, 0.6297933205439666, 0.6371866563045145, 0.6243702651100563, 0.6447988883299542, 0.6019477191373417, 0.624477150402859, 0.6],
        [0.9948910250858436, 0.9677305563891677, 0.9680717076200984, 0.9514889448205005, 0.9049577631536336, 0.8563343502744744, 0.880677724310639, 0.8577381890737142, 0.8967375585795965, 0.9334787291355306, 0.9115684044824139, 0.9089639911285686, 0.8930504215344534, 0.9117673230398344, 0.929608217790094, 0.9778655919467004, 0.9398130116506055, 0.9626734604334533, 0.9721396383200873, 1, 0.9749286529556771, 0.9580087655538184, 1, 1, 1, 1, 1, 1, 1, 0.9664233809980853, 0.9388196842355551, 0.970255513601257, 0.939603397873435, 0.9633004735524644, 0.9662375546948675, 0.9312649438987473, 0.8892119618662495, 0.9222400926192235, 0.9660107567765316, 0.933245200488505, 0.9622636347569091, 0.9253725070752067, 0.9453563620106671, 0.9701100279607311, 0.9227949889198773, 0.8789944272104973, 0.8606289704097683, 0.8718109443874192, 0.9100126673291856]
    ], 70: [
        [0.9905362100231823, 0.9933035967262315, 0.9950321556262555, 0.9909228673696113, 0.9906395648221149, 0.9935157587882972, 0.9906031877021715, 0.9886819210800423, 0.9925761720039832, 0.9927514939182736, 0.9895670743682389, 0.9926545653272396, 0.997640737801874, 0.9978022029130594, 0.9955858347166034, 0.9920338387316917, 0.9950945663711119, 0.9977839895546119, 0.9997782787019092, 0.9949451307916304, 0.9965928989157138, 0.999103472348563, 0.998146831363301, 0.9988907112587636, 0.9985469706145639, 0.9960055042565681, 0.9918520357528254, 0.9935589828113748, 0.9944419370281126, 0.9944460662397959, 0.9972679842180473, 0.9985602811293685, 0.9980319633165949, 0.9955458460130239, 0.9932385782605901, 0.9954420963122826, 0.9919338863036168, 0.9934455635076271, 0.9971955168062259, 0.9966309913571356, 0.99685619879825, 0.999968933710463, 1, 0.9967103872751468, 0.9947957720033442, 0.9925241232281032, 0.9878071765797645, 0.9908803408387655, 0.9872715415725056, 0.9905255120361248, 0.9860861560348264, 0.9828623197563329, 0.9850670956775065, 0.9875403665050473, 0.9873061445684734, 0.9862231874711455, 0.9828245292591762, 0.9832557558911309, 0.9876161646898665, 0.9866283599891258, 0.9863488546732705, 0.9843000027801739, 0.9815261248145508, 0.9772909905725601, 0.9767731922215899, 0.9807496026513157, 0.9766335411585707, 0.9772451840470707, 0.9778814613361234, 0.980410770076688, 0.978485776497442, 0.9801532696180298, 0.9757663687885207, 0.9738821721368087, 0.9737438559105172, 0.9745882974551079, 0.9792458133018586, 0.9773181814462362, 0.9750767075096891, 0.9791991237459388, 0.9839447820028588, 0.9873056484291388, 0.9868849347973737, 0.9839825384467505, 0.9825630010674977, 0.9783179943349428, 0.9815967935681364, 0.9787188182545419, 0.9783247323802872, 0.982857068236069, 0.9805151070497327, 0.9796236343729141, 0.9844675060378026, 0.9874128755475421, 0.9908686948569755, 0.9905834797807372, 0.9954464858871718, 0.997815444608025, 0.9709341398985349, 0.9479571442740834, 0.943735856223367, 0.9074444996342579, 0.954716543651977, 0.9658823491849247, 1, 0.9667767215522597, 0.9805183816379995, 0.9324308427684167, 0.9, 0.9367331266959474, 0.9, 0.9, 0.9, 0.9402625796917605, 0.9120611099096334, 0.9590185250984063, 0.9929792691740214, 0.9867247697848957, 0.9956066674134431, 0.964404249414187, 0.9599396497043969, 0.9793220866920959, 0.9912244100110744, 1, 1, 1, 0.9506290733535652, 0.971526073831481, 0.9482763355739424, 0.9121464556554725, 0.9101426847978248, 0.9, 0.9, 0.9, 0.9, 0.9474175515826608, 0.9135800136398784, 0.9185615524319559, 0.9291969375822869, 0.9476745733461754, 0.9210444603612157, 0.9, 0.9, 0.9, 0.9051616713519441, 0.9075569666326544],
        [0.9321624886130209, 0.931816865042825, 0.9275809241096643, 0.9298848977893965, 0.9297526752835225, 0.9273745826643948, 0.9274112183284783, 0.9267618146558588, 0.9229200027108996, 0.9199415394025136, 0.9222298778580856, 0.924544138779713, 0.9237653602150152, 0.9259894891478586, 0.9264197186485963, 0.929888882980404, 0.9313437471702247, 0.9339109157985614, 0.9341675543732176, 0.9377208421882044, 0.936510356504388, 0.9398067804594521, 0.9352305475354298, 0.9368985019166871, 0.9343662173715175, 0.9362952470488032, 0.931385304460756, 0.9264854165006015, 0.9270168280020508, 0.9284494893090569, 0.9245469557871854, 0.9226889847352511, 0.9273445268733871, 0.9313906971353333, 0.9266409445302675, 0.9229168794100528, 0.9267325520180175, 0.922864223746805, 0.9215815276176321, 0.9208488602697894, 0.9220338211648317, 0.9188603031223922, 0.9145530178650896, 0.9178464210409453, 0.9191079185050676, 0.9188680690705322, 0.9207502259019916, 0.9223702763046773, 0.919343775915133, 0.9177040296191885, 0.9190246921903219, 0.9143435968840394, 0.910086615977249, 0.9052113478912478, 0.9091080058078701, 0.9089610204745967, 0.908848044007206, 0.9050173327485846, 0.9069941817966796, 0.9114849714159485, 0.9141169425671148, 0.9144083672286643, 0.9147005284277743, 0.9124507013306651, 0.9117804883269082, 0.9094544362894562, 0.9090660845631406, 0.9131710617342039, 0.9154080048765214, 0.9149228029172416, 0.9151699460462032, 0.9173055313407983, 0.9155322827279491, 0.9198617647219184, 0.9202354519923354, 0.9193783589334691, 0.915848264823913, 0.9132821064787543, 0.916729309545977, 0.9181819748408329, 0.9139737058240752, 0.9187875304915661, 0.9210888537625721, 0.9185894067774525, 0.9155863367716129, 0.9125803687848244, 0.9146390553359757, 0.9143999346398671, 0.9142268270232604, 0.9102171698638137, 0.9149039903059659, 0.9190421812317653, 0.9146795876871802, 0.9145589848776668, 0.911819594991278, 0.9101866367110418, 0.9119736355000543, 0.9114743258876828, 0.9009312171307118, 0.9, 0.9, 0.9, 0.9, 0.9485456754406751, 0.9783633632129629, 1, 0.9744147841297044, 0.9636336501249184, 0.9167745293467521, 0.9, 0.9304367449940524, 0.9355855011208447, 0.9468020641542231, 0.9891847036484304, 0.9549973681940797, 0.9117414948369978, 0.9, 0.9484813734396959, 0.9876506983916717, 1, 1, 0.9831509932612886, 0.9512888331355734, 0.9989396801659226, 1, 1, 1, 0.9947799300999233, 0.9837725969682942, 0.9686259475879927, 0.9329372085609456, 0.9102823524283961, 0.9264793367973017, 0.9600926502309227, 0.9493331872858869, 0.9620907192840633, 0.964106412258174, 1, 1, 0.986531063559717, 1, 1, 1, 0.9676130830065767, 1, 0.9541464747564362],
        [0.7408705674596461, 0.7430633393243904, 0.7456160031219602, 0.7433389640312527, 0.7412029365895026, 0.7394358057248288, 0.7395174291399513, 0.7392367762545532, 0.7429375941584696, 0.7465154770199244, 0.7469599622496891, 0.745382263381801, 0.7477434444812301, 0.7438053056476591, 0.741120865000225, 0.742068625510066, 0.739186857142933, 0.7368742158826239, 0.7380497363579056, 0.7423339890825805, 0.7453523684760186, 0.7470824913164268, 0.7494131513792542, 0.7498788179011789, 0.7534272962419976, 0.7488334541844187, 0.752718112926004, 0.7557665088304556, 0.754960340805708, 0.758144660788742, 0.7534744704614955, 0.7513179169435593, 0.750272704309443, 0.7464841359963839, 0.7427881017011686, 0.737961099362895, 0.7379765915017203, 0.7354746842714797, 0.7385932265857493, 0.7367200390126483, 0.7350059754860719, 0.7350537210253719, 0.7316160008214402, 0.7344559070737048, 0.7319498708526647, 0.7272232684741539, 0.7251146317431046, 0.7207560932987641, 0.717217313040132, 0.7169770872855453, 0.7123943033240222, 0.7146108291050796, 0.7146121396196665, 0.7121713592138221, 0.7152666923769329, 0.7113655442252158, 0.7081283541028579, 0.7078790785582548, 0.7084125599212991, 0.7122897476247733, 0.7163203342841467, 0.7157768476669808, 0.7179661653138414, 0.7205325268907311, 0.7223203175091579, 0.7257450078961444, 0.7296183978020614, 0.7314768453081532, 0.7333600485523013, 0.7325622536047887, 0.730763216396864, 0.7305676942962366, 0.7275860121203765, 0.7276519603105582, 0.7304301001025054, 0.7350533192296196, 0.7363812323239164, 0.7393083493105473, 0.7416100373585158, 0.7415651361541304, 0.7437576542767076, 0.7416750028768968, 0.7440557308484552, 0.7396566316562403, 0.7401987754260947, 0.7371216020923237, 0.7420306052039793, 0.7381734918685098, 0.7406397334472774, 0.7427818818555938, 0.7439231649999904, 0.7419973216124132, 0.737033701396467, 0.7379780443752401, 0.7384260587879937, 0.7405014483332636, 0.7389961942869362, 0.7219076333308321, 0.7294212952872186, 0.7275929162735614, 0.733899475460986, 0.7505431341367086, 0.7814360579783992, 0.812900959320859, 0.7796374575846938, 0.7710402532777632, 0.7603609874031985, 0.7657049150136711, 0.7654282154226613, 0.7674866912264644, 0.796325347880495, 0.7945825195120979, 0.8350359375107594, 0.8131918863615013, 0.8373789425874599, 0.8865558448695404, 0.8458026986862535, 0.7991202204406084, 0.7543395127981434, 0.766567081368534, 0.745290005409746, 0.7446254473153587, 0.7470512168390604, 0.7122705690859139, 0.7322713710972759, 0.7461170628180309, 0.7875098407120591, 0.8045848480585268, 0.822806988142077, 0.8573994514232448, 0.8957500078202011, 0.8459653230098036, 0.8459178760066295, 0.8662005167294178, 0.903513550326957, 0.8602800389517901, 0.8722641019492317, 0.8355785671623486, 0.8750952228449055, 0.8693549894001948, 0.8877335881155558, 0.8882724938500325, 0.8968815127935625, 0.9109379666688314, 0.8790608705804155, 0.8868151223794652],
        [0.8217520859024565, 0.8170147045524337, 0.8165487235281089, 0.8196857334240047, 0.8244354435132406, 0.8206442006458724, 0.820513298641068, 0.8156956379438296, 0.8112347227853703, 0.8156351204427774, 0.8114688837502178, 0.8162955557910132, 0.8132715281906893, 0.81236689914154, 0.8081975284963944, 0.8107078391617647, 0.8060953472996808, 0.8103494978922671, 0.8117194984911633, 0.8145486937371244, 0.8157426765477025, 0.8203625416478005, 0.8161531314129826, 0.8210504627503484, 0.8162545591647891, 0.818606164654772, 0.8202528664569301, 0.8193731015677342, 0.8148048076693397, 0.8184256446006419, 0.8134508115543327, 0.8155107011641389, 0.8151115046920497, 0.8199318688308712, 0.8182396741874065, 0.821856831237598, 0.8233050936743416, 0.8227386943061231, 0.8200420520654985, 0.8202067450799102, 0.8226982343978506, 0.8183965443657372, 0.8208951204663917, 0.8231882943648042, 0.8256701549106525, 0.8247341659505258, 0.8220744677382854, 0.8190522382971045, 0.8230511456623365, 0.8266981021962436, 0.8285894789885325, 0.8332598878318234, 0.8342522361175634, 0.8362672849613978, 0.8369258013373945, 0.8323896770506332, 0.831151871417557, 0.8281101248504936, 0.8262161283192107, 0.8232481066747348, 0.8271944873824885, 0.8244164317531796, 0.8286412424493454, 0.8314553502501312, 0.8282598430019401, 0.8280171122224301, 0.8250465481813057, 0.8287841286170192, 0.8273141715720785, 0.826721285994133, 0.8233719058224833, 0.823181472318158, 0.825496012489724, 0.8266658125623239, 0.8289168555363089, 0.8336755564279213, 0.8296992664998608, 0.8312772249476762, 0.8282126555354775, 0.8269994300334734, 0.8241397087071524, 0.8198041610040477, 0.8217151952253146, 0.8194413873180911, 0.8148676450044701, 0.8169544389468272, 0.8125298227385637, 0.8144002547234164, 0.8108671405066906, 0.8070177914690009, 0.8106909144651293, 0.8068259416901951, 0.8026227406153316, 0.7986255819416938, 0.8000685788698088, 0.7978591757609034, 0.7972465322990725, 0.8145441071190311, 0.8127056074917223, 0.8317251872019263, 0.8657856527868365, 0.8255134810527155, 0.84414686032774, 0.859852619203778, 0.827610412595408, 0.8657616372083176, 0.8800701527875551, 0.9267031766084913, 0.8869021113455617, 0.9296584497553544, 0.9298164661487227, 0.9503836616300039, 0.9932089854802928, 1, 0.9972938550121695, 0.9637435563755579, 0.9597947745797138, 0.9316770515762981, 0.9242050352243417, 0.9452769656843645, 0.9344103858721711, 0.9346046676392163, 0.9174127948720415, 0.9193341498992672, 0.874250404972009, 0.8926611406586797, 0.8572685310379634, 0.8355785155663245, 0.8436180135078089, 0.8905573569057385, 0.8431631316069288, 0.8398313623682535, 0.8227361727401907, 0.8568693918631162, 0.8766935445399698, 0.8571603073837062, 0.9041921697831731, 0.9471624667655175, 0.9065681399182823, 0.9249747767431438, 0.9174914549535456, 0.9444889630322295, 0.917478667744452, 0.9296512468437942, 0.8992594127053958, 0.9117350767822469],
        [0.7408705674596461, 0.7430633393243904, 0.7456160031219602, 0.7433389640312527, 0.7412029365895026, 0.7394358057248288, 0.7395174291399513, 0.7392367762545532, 0.7429375941584696, 0.7465154770199244, 0.7469599622496891, 0.745382263381801, 0.7477434444812301, 0.7438053056476591, 0.741120865000225, 0.742068625510066, 0.739186857142933, 0.7368742158826239, 0.7380497363579056, 0.7423339890825805, 0.7453523684760186, 0.7470824913164268, 0.7494131513792542, 0.7498788179011789, 0.7534272962419976, 0.7488334541844187, 0.752718112926004, 0.7557665088304556, 0.754960340805708, 0.758144660788742, 0.7534744704614955, 0.7513179169435593, 0.750272704309443, 0.7464841359963839, 0.7427881017011686, 0.737961099362895, 0.7379765915017203, 0.7354746842714797, 0.7385932265857493, 0.7367200390126483, 0.7350059754860719, 0.7350537210253719, 0.7316160008214402, 0.7344559070737048, 0.7319498708526647, 0.7272232684741539, 0.7251146317431046, 0.7207560932987641, 0.717217313040132, 0.7169770872855453, 0.7123943033240222, 0.7146108291050796, 0.7146121396196665, 0.7121713592138221, 0.7152666923769329, 0.7113655442252158, 0.7081283541028579, 0.7078790785582548, 0.7084125599212991, 0.7122897476247733, 0.7163203342841467, 0.7157768476669808, 0.7179661653138414, 0.7205325268907311, 0.7223203175091579, 0.7257450078961444, 0.7296183978020614, 0.7314768453081532, 0.7333600485523013, 0.7325622536047887, 0.730763216396864, 0.7305676942962366, 0.7275860121203765, 0.7276519603105582, 0.7304301001025054, 0.7350533192296196, 0.7363812323239164, 0.7393083493105473, 0.7416100373585158, 0.7415651361541304, 0.7437576542767076, 0.7416750028768968, 0.7440557308484552, 0.7396566316562403, 0.7401987754260947, 0.7371216020923237, 0.7420306052039793, 0.7381734918685098, 0.7406397334472774, 0.7427818818555938, 0.7439231649999904, 0.7419973216124132, 0.737033701396467, 0.7379780443752401, 0.7384260587879937, 0.7405014483332636, 0.7389961942869362, 0.7219076333308321, 0.7294212952872186, 0.7275929162735614, 0.733899475460986, 0.7505431341367086, 0.7814360579783992, 0.812900959320859, 0.7796374575846938, 0.7710402532777632, 0.7603609874031985, 0.7657049150136711, 0.7654282154226613, 0.7674866912264644, 0.796325347880495, 0.7945825195120979, 0.8350359375107594, 0.8131918863615013, 0.8373789425874599, 0.8865558448695404, 0.8458026986862535, 0.7991202204406084, 0.7543395127981434, 0.766567081368534, 0.745290005409746, 0.7446254473153587, 0.7470512168390604, 0.7122705690859139, 0.7322713710972759, 0.7461170628180309, 0.7875098407120591, 0.8045848480585268, 0.822806988142077, 0.8573994514232448, 0.8957500078202011, 0.8459653230098036, 0.8459178760066295, 0.8662005167294178, 0.903513550326957, 0.8602800389517901, 0.8722641019492317, 0.8355785671623486, 0.8750952228449055, 0.8693549894001948, 0.8877335881155558, 0.8882724938500325, 0.8968815127935625, 0.9109379666688314, 0.8790608705804155, 0.8868151223794652],
        [0.9905362100231823, 0.9933035967262315, 0.9950321556262555, 0.9909228673696113, 0.9906395648221149, 0.9935157587882972, 0.9906031877021715, 0.9886819210800423, 0.9925761720039832, 0.9927514939182736, 0.9895670743682389, 0.9926545653272396, 0.997640737801874, 0.9978022029130594, 0.9955858347166034, 0.9920338387316917, 0.9950945663711119, 0.9977839895546119, 0.9997782787019092, 0.9949451307916304, 0.9965928989157138, 0.999103472348563, 0.998146831363301, 0.9988907112587636, 0.9985469706145639, 0.9960055042565681, 0.9918520357528254, 0.9935589828113748, 0.9944419370281126, 0.9944460662397959, 0.9972679842180473, 0.9985602811293685, 0.9980319633165949, 0.9955458460130239, 0.9932385782605901, 0.9954420963122826, 0.9919338863036168, 0.9934455635076271, 0.9971955168062259, 0.9966309913571356, 0.99685619879825, 0.999968933710463, 1, 0.9967103872751468, 0.9947957720033442, 0.9925241232281032, 0.9878071765797645, 0.9908803408387655, 0.9872715415725056, 0.9905255120361248, 0.9860861560348264, 0.9828623197563329, 0.9850670956775065, 0.9875403665050473, 0.9873061445684734, 0.9862231874711455, 0.9828245292591762, 0.9832557558911309, 0.9876161646898665, 0.9866283599891258, 0.9863488546732705, 0.9843000027801739, 0.9815261248145508, 0.9772909905725601, 0.9767731922215899, 0.9807496026513157, 0.9766335411585707, 0.9772451840470707, 0.9778814613361234, 0.980410770076688, 0.978485776497442, 0.9801532696180298, 0.9757663687885207, 0.9738821721368087, 0.9737438559105172, 0.9745882974551079, 0.9792458133018586, 0.9773181814462362, 0.9750767075096891, 0.9791991237459388, 0.9839447820028588, 0.9873056484291388, 0.9868849347973737, 0.9839825384467505, 0.9825630010674977, 0.9783179943349428, 0.9815967935681364, 0.9787188182545419, 0.9783247323802872, 0.982857068236069, 0.9805151070497327, 0.9796236343729141, 0.9844675060378026, 0.9874128755475421, 0.9908686948569755, 0.9905834797807372, 0.9954464858871718, 0.997815444608025, 0.9709341398985349, 0.9479571442740834, 0.943735856223367, 0.9074444996342579, 0.954716543651977, 0.9658823491849247, 1, 0.9667767215522597, 0.9805183816379995, 0.9324308427684167, 0.9, 0.9367331266959474, 0.9, 0.9, 0.9, 0.9402625796917605, 0.9120611099096334, 0.9590185250984063, 0.9929792691740214, 0.9867247697848957, 0.9956066674134431, 0.964404249414187, 0.9599396497043969, 0.9793220866920959, 0.9912244100110744, 1, 1, 1, 0.9506290733535652, 0.971526073831481, 0.9482763355739424, 0.9121464556554725, 0.9101426847978248, 0.9, 0.9, 0.9, 0.9, 0.9474175515826608, 0.9135800136398784, 0.9185615524319559, 0.9291969375822869, 0.9476745733461754, 0.9210444603612157, 0.9, 0.9, 0.9, 0.9051616713519441, 0.9075569666326544],
        [0.9321624886130209, 0.931816865042825, 0.9275809241096643, 0.9298848977893965, 0.9297526752835225,
         0.9273745826643948, 0.9274112183284783, 0.9267618146558588, 0.9229200027108996, 0.9199415394025136,
         0.9222298778580856, 0.924544138779713, 0.9237653602150152, 0.9259894891478586, 0.9264197186485963,
         0.929888882980404, 0.9313437471702247, 0.9339109157985614, 0.9341675543732176, 0.9377208421882044,
         0.936510356504388, 0.9398067804594521, 0.9352305475354298, 0.9368985019166871, 0.9343662173715175,
         0.9362952470488032, 0.931385304460756, 0.9264854165006015, 0.9270168280020508, 0.9284494893090569,
         0.9245469557871854, 0.9226889847352511, 0.9273445268733871, 0.9313906971353333, 0.9266409445302675,
         0.9229168794100528, 0.9267325520180175, 0.922864223746805, 0.9215815276176321, 0.9208488602697894,
         0.9220338211648317, 0.9188603031223922, 0.9145530178650896, 0.9178464210409453, 0.9191079185050676,
         0.9188680690705322, 0.9207502259019916, 0.9223702763046773, 0.919343775915133, 0.9177040296191885,
         0.9190246921903219, 0.9143435968840394, 0.910086615977249, 0.9052113478912478, 0.9091080058078701,
         0.9089610204745967, 0.908848044007206, 0.9050173327485846, 0.9069941817966796, 0.9114849714159485,
         0.9141169425671148, 0.9144083672286643, 0.9147005284277743, 0.9124507013306651, 0.9117804883269082,
         0.9094544362894562, 0.9090660845631406, 0.9131710617342039, 0.9154080048765214, 0.9149228029172416,
         0.9151699460462032, 0.9173055313407983, 0.9155322827279491, 0.9198617647219184, 0.9202354519923354,
         0.9193783589334691, 0.915848264823913, 0.9132821064787543, 0.916729309545977, 0.9181819748408329,
         0.9139737058240752, 0.9187875304915661, 0.9210888537625721, 0.9185894067774525, 0.9155863367716129,
         0.9125803687848244, 0.9146390553359757, 0.9143999346398671, 0.9142268270232604, 0.9102171698638137,
         0.9149039903059659, 0.9190421812317653, 0.9146795876871802, 0.9145589848776668, 0.911819594991278,
         0.9101866367110418, 0.9119736355000543, 0.9114743258876828, 0.9009312171307118, 0.9, 0.9, 0.9, 0.9,
         0.9485456754406751, 0.9783633632129629, 1, 0.9744147841297044, 0.9636336501249184, 0.9167745293467521, 0.9,
         0.9304367449940524, 0.9355855011208447, 0.9468020641542231, 0.9891847036484304, 0.9549973681940797,
         0.9117414948369978, 0.9, 0.9484813734396959, 0.9876506983916717, 1, 1, 0.9831509932612886, 0.9512888331355734,
         0.9989396801659226, 1, 1, 1, 0.9947799300999233, 0.9837725969682942, 0.9686259475879927, 0.9329372085609456,
         0.9102823524283961, 0.9264793367973017, 0.9600926502309227, 0.9493331872858869, 0.9620907192840633,
         0.964106412258174, 1, 1, 0.986531063559717, 1, 1, 1, 0.9676130830065767, 1, 0.9541464747564362],
        [0.7408705674596461, 0.7430633393243904, 0.7456160031219602, 0.7433389640312527, 0.7412029365895026,
         0.7394358057248288, 0.7395174291399513, 0.7392367762545532, 0.7429375941584696, 0.7465154770199244,
         0.7469599622496891, 0.745382263381801, 0.7477434444812301, 0.7438053056476591, 0.741120865000225,
         0.742068625510066, 0.739186857142933, 0.7368742158826239, 0.7380497363579056, 0.7423339890825805,
         0.7453523684760186, 0.7470824913164268, 0.7494131513792542, 0.7498788179011789, 0.7534272962419976,
         0.7488334541844187, 0.752718112926004, 0.7557665088304556, 0.754960340805708, 0.758144660788742,
         0.7534744704614955, 0.7513179169435593, 0.750272704309443, 0.7464841359963839, 0.7427881017011686,
         0.737961099362895, 0.7379765915017203, 0.7354746842714797, 0.7385932265857493, 0.7367200390126483,
         0.7350059754860719, 0.7350537210253719, 0.7316160008214402, 0.7344559070737048, 0.7319498708526647,
         0.7272232684741539, 0.7251146317431046, 0.7207560932987641, 0.717217313040132, 0.7169770872855453,
         0.7123943033240222, 0.7146108291050796, 0.7146121396196665, 0.7121713592138221, 0.7152666923769329,
         0.7113655442252158, 0.7081283541028579, 0.7078790785582548, 0.7084125599212991, 0.7122897476247733,
         0.7163203342841467, 0.7157768476669808, 0.7179661653138414, 0.7205325268907311, 0.7223203175091579,
         0.7257450078961444, 0.7296183978020614, 0.7314768453081532, 0.7333600485523013, 0.7325622536047887,
         0.730763216396864, 0.7305676942962366, 0.7275860121203765, 0.7276519603105582, 0.7304301001025054,
         0.7350533192296196, 0.7363812323239164, 0.7393083493105473, 0.7416100373585158, 0.7415651361541304,
         0.7437576542767076, 0.7416750028768968, 0.7440557308484552, 0.7396566316562403, 0.7401987754260947,
         0.7371216020923237, 0.7420306052039793, 0.7381734918685098, 0.7406397334472774, 0.7427818818555938,
         0.7439231649999904, 0.7419973216124132, 0.737033701396467, 0.7379780443752401, 0.7384260587879937,
         0.7405014483332636, 0.7389961942869362, 0.7219076333308321, 0.7294212952872186, 0.7275929162735614,
         0.733899475460986, 0.7505431341367086, 0.7814360579783992, 0.812900959320859, 0.7796374575846938,
         0.7710402532777632, 0.7603609874031985, 0.7657049150136711, 0.7654282154226613, 0.7674866912264644,
         0.796325347880495, 0.7945825195120979, 0.8350359375107594, 0.8131918863615013, 0.8373789425874599,
         0.8865558448695404, 0.8458026986862535, 0.7991202204406084, 0.7543395127981434, 0.766567081368534,
         0.745290005409746, 0.7446254473153587, 0.7470512168390604, 0.7122705690859139, 0.7322713710972759,
         0.7461170628180309, 0.7875098407120591, 0.8045848480585268, 0.822806988142077, 0.8573994514232448,
         0.8957500078202011, 0.8459653230098036, 0.8459178760066295, 0.8662005167294178, 0.903513550326957,
         0.8602800389517901, 0.8722641019492317, 0.8355785671623486, 0.8750952228449055, 0.8693549894001948,
         0.8877335881155558, 0.8882724938500325, 0.8968815127935625, 0.9109379666688314, 0.8790608705804155,
         0.8868151223794652],
        [0.8217520859024565, 0.8170147045524337, 0.8165487235281089, 0.8196857334240047, 0.8244354435132406,
         0.8206442006458724, 0.820513298641068, 0.8156956379438296, 0.8112347227853703, 0.8156351204427774,
         0.8114688837502178, 0.8162955557910132, 0.8132715281906893, 0.81236689914154, 0.8081975284963944,
         0.8107078391617647, 0.8060953472996808, 0.8103494978922671, 0.8117194984911633, 0.8145486937371244,
         0.8157426765477025, 0.8203625416478005, 0.8161531314129826, 0.8210504627503484, 0.8162545591647891,
         0.818606164654772, 0.8202528664569301, 0.8193731015677342, 0.8148048076693397, 0.8184256446006419,
         0.8134508115543327, 0.8155107011641389, 0.8151115046920497, 0.8199318688308712, 0.8182396741874065,
         0.821856831237598, 0.8233050936743416, 0.8227386943061231, 0.8200420520654985, 0.8202067450799102,
         0.8226982343978506, 0.8183965443657372, 0.8208951204663917, 0.8231882943648042, 0.8256701549106525,
         0.8247341659505258, 0.8220744677382854, 0.8190522382971045, 0.8230511456623365, 0.8266981021962436,
         0.8285894789885325, 0.8332598878318234, 0.8342522361175634, 0.8362672849613978, 0.8369258013373945,
         0.8323896770506332, 0.831151871417557, 0.8281101248504936, 0.8262161283192107, 0.8232481066747348,
         0.8271944873824885, 0.8244164317531796, 0.8286412424493454, 0.8314553502501312, 0.8282598430019401,
         0.8280171122224301, 0.8250465481813057, 0.8287841286170192, 0.8273141715720785, 0.826721285994133,
         0.8233719058224833, 0.823181472318158, 0.825496012489724, 0.8266658125623239, 0.8289168555363089,
         0.8336755564279213, 0.8296992664998608, 0.8312772249476762, 0.8282126555354775, 0.8269994300334734,
         0.8241397087071524, 0.8198041610040477, 0.8217151952253146, 0.8194413873180911, 0.8148676450044701,
         0.8169544389468272, 0.8125298227385637, 0.8144002547234164, 0.8108671405066906, 0.8070177914690009,
         0.8106909144651293, 0.8068259416901951, 0.8026227406153316, 0.7986255819416938, 0.8000685788698088,
         0.7978591757609034, 0.7972465322990725, 0.8145441071190311, 0.8127056074917223, 0.8317251872019263,
         0.8657856527868365, 0.8255134810527155, 0.84414686032774, 0.859852619203778, 0.827610412595408,
         0.8657616372083176, 0.8800701527875551, 0.9267031766084913, 0.8869021113455617, 0.9296584497553544,
         0.9298164661487227, 0.9503836616300039, 0.9932089854802928, 1, 0.9972938550121695, 0.9637435563755579,
         0.9597947745797138, 0.9316770515762981, 0.9242050352243417, 0.9452769656843645, 0.9344103858721711,
         0.9346046676392163, 0.9174127948720415, 0.9193341498992672, 0.874250404972009, 0.8926611406586797,
         0.8572685310379634, 0.8355785155663245, 0.8436180135078089, 0.8905573569057385, 0.8431631316069288,
         0.8398313623682535, 0.8227361727401907, 0.8568693918631162, 0.8766935445399698, 0.8571603073837062,
         0.9041921697831731, 0.9471624667655175, 0.9065681399182823, 0.9249747767431438, 0.9174914549535456,
         0.9444889630322295, 0.917478667744452, 0.9296512468437942, 0.8992594127053958, 0.9117350767822469],
        [0.7408705674596461, 0.7430633393243904, 0.7456160031219602, 0.7433389640312527, 0.7412029365895026,
         0.7394358057248288, 0.7395174291399513, 0.7392367762545532, 0.7429375941584696, 0.7465154770199244,
         0.7469599622496891, 0.745382263381801, 0.7477434444812301, 0.7438053056476591, 0.741120865000225,
         0.742068625510066, 0.739186857142933, 0.7368742158826239, 0.7380497363579056, 0.7423339890825805,
         0.7453523684760186, 0.7470824913164268, 0.7494131513792542, 0.7498788179011789, 0.7534272962419976,
         0.7488334541844187, 0.752718112926004, 0.7557665088304556, 0.754960340805708, 0.758144660788742,
         0.7534744704614955, 0.7513179169435593, 0.750272704309443, 0.7464841359963839, 0.7427881017011686,
         0.737961099362895, 0.7379765915017203, 0.7354746842714797, 0.7385932265857493, 0.7367200390126483,
         0.7350059754860719, 0.7350537210253719, 0.7316160008214402, 0.7344559070737048, 0.7319498708526647,
         0.7272232684741539, 0.7251146317431046, 0.7207560932987641, 0.717217313040132, 0.7169770872855453,
         0.7123943033240222, 0.7146108291050796, 0.7146121396196665, 0.7121713592138221, 0.7152666923769329,
         0.7113655442252158, 0.7081283541028579, 0.7078790785582548, 0.7084125599212991, 0.7122897476247733,
         0.7163203342841467, 0.7157768476669808, 0.7179661653138414, 0.7205325268907311, 0.7223203175091579,
         0.7257450078961444, 0.7296183978020614, 0.7314768453081532, 0.7333600485523013, 0.7325622536047887,
         0.730763216396864, 0.7305676942962366, 0.7275860121203765, 0.7276519603105582, 0.7304301001025054,
         0.7350533192296196, 0.7363812323239164, 0.7393083493105473, 0.7416100373585158, 0.7415651361541304,
         0.7437576542767076, 0.7416750028768968, 0.7440557308484552, 0.7396566316562403, 0.7401987754260947,
         0.7371216020923237, 0.7420306052039793, 0.7381734918685098, 0.7406397334472774, 0.7427818818555938,
         0.7439231649999904, 0.7419973216124132, 0.737033701396467, 0.7379780443752401, 0.7384260587879937,
         0.7405014483332636, 0.7389961942869362, 0.7219076333308321, 0.7294212952872186, 0.7275929162735614,
         0.733899475460986, 0.7505431341367086, 0.7814360579783992, 0.812900959320859, 0.7796374575846938,
         0.7710402532777632, 0.7603609874031985, 0.7657049150136711, 0.7654282154226613, 0.7674866912264644,
         0.796325347880495, 0.7945825195120979, 0.8350359375107594, 0.8131918863615013, 0.8373789425874599,
         0.8865558448695404, 0.8458026986862535, 0.7991202204406084, 0.7543395127981434, 0.766567081368534,
         0.745290005409746, 0.7446254473153587, 0.7470512168390604, 0.7122705690859139, 0.7322713710972759,
         0.7461170628180309, 0.7875098407120591, 0.8045848480585268, 0.822806988142077, 0.8573994514232448,
         0.8957500078202011, 0.8459653230098036, 0.8459178760066295, 0.8662005167294178, 0.903513550326957,
         0.8602800389517901, 0.8722641019492317, 0.8355785671623486, 0.8750952228449055, 0.8693549894001948,
         0.8877335881155558, 0.8882724938500325, 0.8968815127935625, 0.9109379666688314, 0.8790608705804155,
         0.8868151223794652]

    ], 80: [
        [0.9838755394257631, 1, 1, 1, 0.9954805512431495, 1, 1, 1, 0.9829200295992212, 1, 0.9812150965985531, 1, 0.9511237228663675, 0.9043839963902159, 0.8661239308279808, 0.9148012942077659, 0.8862882071804761, 0.8470211915582216, 0.8942112955225892, 0.8870722863616164, 0.8874392898632746, 0.9073295574192185, 0.8968785815655921, 0.856027147807079, 0.8203152517644257, 0.8175814888360589, 0.8, 0.8354398079030544, 0.8092255217385419, 0.8369042380852262, 0.8519436474299182, 0.8386588470310583, 0.8196264850856443, 0.8, 0.8443540995887698, 0.8536800089731915, 0.845098396710241, 0.8151132866098783, 0.8077190510656089, 0.817871871381434, 0.8117206503781893, 0.8238988064282092, 0.8, 0.8359495351753107, 0.8305896930023906, 0.8470503309400821, 0.8594192138680283, 0.8230794421837797, 0.8524538371889104],
        [0.8432126693458223, 0.8469128871708965, 0.8666860486576883, 0.9161259656806439, 0.9433061667669039, 0.9852057106071264, 1, 1, 1, 1, 1, 0.9988655119991041, 1, 1, 0.9753820870836654, 0.9402857165908375, 0.9846756027014119, 0.9791500782054847, 0.9680500281130846, 0.9580819920810265, 0.938807308562077, 0.914400438229744, 0.9342176645358062, 0.9270563208299295, 0.9562518452371562, 1, 0.9706871634140911, 0.9426596863538759, 0.9403263445692057, 0.9696676570705729, 1, 0.9817115405546042, 0.9640147401272542, 0.9899666851651611, 1, 1, 0.9768959352098292, 0.9312823390256716, 0.9728292716792502, 0.9351929948749822, 0.9636476302508299, 0.9976356713186216, 1, 1, 1, 0.9527441778082815, 0.9721289203139569, 0.9568151715931061, 0.9591224334015696],
        [0.9240974320739821, 0.9570038386315443, 0.9617602348116218, 0.9671678646846504, 0.954400532452241, 0.9537166529524175, 0.918192373737023, 0.8978938552488014, 0.9335855142077386, 0.8970886872185455, 0.8773316968085, 0.829128026037533, 0.865520676484421, 0.830850579820906, 0.821141232406912, 0.8, 0.8246678307377437, 0.8507899840056448, 0.8413909575657883, 0.8523956908803539, 0.8974921407714092, 0.8573622638517548, 0.8908196420563768, 0.9224322936558154, 0.8774404538828936, 0.9256759154278003, 0.9192604934643479, 0.9470270460416553, 0.9011905858453234, 0.95028288374685, 0.9305682423619807, 0.9495153479443306, 0.9988341636237456, 0.9980304566030163, 0.9930372695711834, 0.9537453015959131, 0.9406739594940536, 0.9272297917427073, 0.968049777678939, 0.9575273204961756, 0.9286764690540263, 0.89194652672077, 0.9370833408944624, 0.8908138058927174, 0.9118733081149779, 0.8817070495646638, 0.8713777135618661, 0.8757579342660742, 0.9093938598281991],
        [0.8875741478917475, 0.8944765709299711, 0.9232747439736013, 0.923736598361967, 0.9447915219316589, 0.9573811195042576, 0.9118150246114297, 0.8756763754636551, 0.8827151155761398, 0.8445718160099327, 0.8211485458121073, 0.8155042921764235, 0.8, 0.8092453743578023, 0.8, 0.8, 0.8, 0.8010540402193859, 0.8230317862778269, 0.8559607911355763, 0.8710341099265255, 0.8456633824675257, 0.8803848606317954, 0.838174877355016, 0.8730515827966479, 0.9226968064569837, 0.9272900832116602, 0.9169021318736889, 0.8963554401075752, 0.8533122282042552, 0.8118008166866859, 0.8064787315355525, 0.8, 0.8043829042967298, 0.850590569261939, 0.8609106754654746, 0.8455777963570881, 0.815177726983678, 0.8, 0.8130117668211677, 0.8140318362245004, 0.8, 0.8102449936525713, 0.8, 0.8024367424355602, 0.8380595533614814, 0.8, 0.8, 0.8128672020002233]
    ], 90: [
        [0.997815444608025, 0.9709341398985349, 0.9479571442740834, 0.943735856223367, 0.9074444996342579, 0.954716543651977, 0.9658823491849247, 1, 0.9667767215522597, 0.9805183816379995, 0.9324308427684167, 0.9, 0.9367331266959474, 0.9, 0.9, 0.9, 0.9402625796917605, 0.9120611099096334, 0.9590185250984063, 0.9929792691740214, 0.9867247697848957, 0.9956066674134431, 0.964404249414187, 0.9599396497043969, 0.9793220866920959, 0.9912244100110744, 1, 1, 1, 0.9506290733535652, 0.971526073831481, 0.9482763355739424, 0.9121464556554725, 0.9101426847978248, 0.9, 0.9, 0.9, 0.9, 0.9474175515826608, 0.9135800136398784, 0.9185615524319559, 0.9291969375822869, 0.9476745733461754, 0.9210444603612157, 0.9, 0.9, 0.9, 0.9051616713519441, 0.9075569666326544],
        [0.9114743258876828, 0.9009312171307118, 0.9, 0.9, 0.9, 0.9, 0.9485456754406751, 0.9783633632129629, 1, 0.9744147841297044, 0.9636336501249184, 0.9167745293467521, 0.9, 0.9304367449940524, 0.9355855011208447, 0.9468020641542231, 0.9891847036484304, 0.9549973681940797, 0.9117414948369978, 0.9, 0.9484813734396959, 0.9876506983916717, 1, 1, 0.9831509932612886, 0.9512888331355734, 0.9989396801659226, 1, 1, 1, 0.9947799300999233, 0.9837725969682942, 0.9686259475879927, 0.9329372085609456, 0.9102823524283961, 0.9264793367973017, 0.9600926502309227, 0.9493331872858869, 0.9620907192840633, 0.964106412258174, 1, 1, 0.986531063559717, 1, 1, 1, 0.9676130830065767, 1, 0.9541464747564362],
        [0.9280113712977989, 0.9, 0.9257797605854694, 0.960264255722769, 0.9733963270099916, 0.9542007887178188, 0.9765507037352141, 0.9547300435853072, 1, 1, 1, 1, 1, 0.9541104531066358, 0.9467421478583463, 0.9861521993234401, 0.9624822013504113, 0.9600939600709787, 0.9207243794373015, 0.9641664610259231, 0.9844228843056179, 1, 1, 0.9567759885430053, 0.9986138398388087, 0.965053589259092, 0.9989081826383934, 1, 1, 0.9856389070150169, 0.9900068936773416, 1, 1, 1, 1, 0.9823506048333239, 0.9615587950190329, 1, 1, 1, 1, 1, 1, 1, 0.9910518546122926, 0.9759323583301993, 0.996570788931326, 1, 1],
        [0.997215485091831, 0.9478775010713855, 0.9558702853693589, 0.9506650324612573, 0.9582310858904729, 0.9487415389704456, 0.967195576917766, 0.9685565228233309, 0.9655478170192835, 0.9385006750234564, 0.9, 0.9, 0.9, 0.9, 0.9095339644154653, 0.9246969037892476, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9352143233753754, 0.9317620574820993, 0.9180699265192375, 0.9, 0.9, 0.9103200865310935, 0.9275248494878252, 0.9621358942567725, 0.9949400828768798, 0.9733749445212666, 1, 1, 1, 0.9757099907506193, 0.949116429744512, 0.9019916238533642, 0.9417860638733575, 0.981409757209689, 1, 0.969743594587389, 1, 0.995677576343564, 0.9590856048296718, 0.918324461326197, 0.9, 0.9125040806357184, 0.9]
    ]
}


class User:
    """A User getting data from the satellite"""
    def __init__(self, agent_id, snr_min):
        self.agent_id = agent_id

        # self.snr_noise = [np.random.uniform(SNR_NOISE_LOW, 1)]
        self.snr_noise = TMP_SNR[snr_min][self.agent_id]
        self.index = -1

        self.download_log = {}

        self.sat_log = {}

        # just consider downlink for now; more interesting for most apps anyways
        self.log = structlog.get_logger(agent_id=self.agent_id)
        self.log.debug('User init', agent_id=self.agent_id)

    def __repr__(self):
        return str(self.agent_id)

    def get_snr_noise(self, mahimahi_ptr=None):
        # return self.snr_noise[-1]
        # mahimahi_ptr = int(mahimahi_ptr)
        if mahimahi_ptr:
            if mahimahi_ptr < 0:
                mahimahi_ptr = 0
            try:
                return self.snr_noise[mahimahi_ptr]
            except IndexError:
                print(len(self.snr_noise))
                print(mahimahi_ptr)
        else:
            return self.snr_noise[self.index]

    def get_snr_log(self):
        return self.snr_noise

    def update_sat_log(self, sat_id, mahimahi_ptr):
        self.sat_log[mahimahi_ptr] = sat_id

    def get_conn_sat_id(self, mahimahi_ptr):
        self.log.debug("get_conn_sat_id", log=self.sat_log, ptr=mahimahi_ptr)
        sat_id = None
        for i in sorted(self.sat_log.keys()):
            if mahimahi_ptr < i:
                break
            sat_id = self.sat_log[i]

        return sat_id

    def update_snr_noise(self, mahimahi_ptr=None):
        """
        self.snr_noise.append(self.snr_noise[-1] + np.random.uniform(-SNR_NOISE_UNIT, SNR_NOISE_UNIT))

        if self.snr_noise[-1] > 1:
            self.snr_noise[-1] = 1
        elif self.snr_noise[-1] < SNR_NOISE_LOW:
            self.snr_noise[-1] = SNR_NOISE_LOW

        return self.snr_noise[-1]

        """
        if mahimahi_ptr:
            self.index = int(mahimahi_ptr)
        else:
            self.index += 1
        return self.snr_noise[self.index]

    def get_agent_id(self):
        return self.agent_id

    def update_download(self, mahimahi_ptr, sat_id, video_chunk_remain, quality, last_quality, buf_size):
        self.download_log[mahimahi_ptr] = [sat_id, video_chunk_remain, quality, last_quality, buf_size]

    def get_related_download_logs(self, mahimahi_ptr, target_mahimahi_ptr):
        self.log.debug('download_log', download_log=self.download_log)
        if not self.download_log:
            return [None] * 6
        final_logs = []
        video_chunk_remain = None
        sat_id = None
        last_quality = None
        buf_size = None
        first_mahimahi_ptr = None
        min_idx = None
        ptr_list = sorted(self.download_log.keys())
        for ptr in range(len(ptr_list)):
            if ptr > target_mahimahi_ptr:
                break
            min_idx = ptr
        if min_idx is None or np.abs(mahimahi_ptr - ptr_list[min_idx]) > np.abs(mahimahi_ptr - target_mahimahi_ptr):
            return [None] * 6
        if min_idx != 0:
            last_quality = self.download_log[ptr_list[min_idx-1]][3]

        if video_chunk_remain is None:
            video_chunk_remain = self.download_log[ptr_list[min_idx]][1]
        if sat_id is None:
            sat_id = self.download_log[ptr_list[min_idx]][0]
        if buf_size is None:
            buf_size = self.download_log[ptr_list[min_idx]][4]
        if first_mahimahi_ptr is None:
            first_mahimahi_ptr = ptr_list[min_idx]

        for i in range(min_idx, len(ptr_list)):
            final_logs.append(self.download_log[ptr_list[i]])

        return first_mahimahi_ptr, sat_id, video_chunk_remain, final_logs, last_quality, buf_size

"""
snr_noise = [np.random.uniform(SNR_NOISE_LOW, 1)]
for _ in range(TOTAL_VIDEO_CHUNKS*2):
    snr_noise.append(snr_noise[-1] + np.random.uniform(-SNR_NOISE_UNIT, SNR_NOISE_UNIT))
    if snr_noise[-1] > 1:
        snr_noise[-1] = 1
    elif snr_noise[-1] < SNR_NOISE_LOW:
        snr_noise[-1] = SNR_NOISE_LOW
print(snr_noise)
"""